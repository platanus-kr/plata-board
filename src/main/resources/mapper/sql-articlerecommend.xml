<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.platanus.webboard.domain.MyBatis.MyBatisArticleRecommendMapper">

    <resultMap id="articleRecommendMap" type="articleRecommendAlias">
        <id column="id" property="id"/>
        <result column="article_id" property="articleId"/>
        <result column="user_id" property="userId"/>
    </resultMap>

    <insert id="save" parameterType="articleRecommendAlias" useGeneratedKeys="true" keyProperty="id">
        insert into ARTICLES_RECOMMEND(ARTICLE_ID,
                                       USER_ID)
        values (#{articleRecommend.articleId},
                #{articleRecommend.userId})
    </insert>

    <select id="findByArticleIdAndUserId" parameterType="map" resultMap="articleRecommendMap">
        select *
        from ARTICLES_RECOMMEND
        where ARTICLE_ID = #{articleId}
          and USER_ID = #{userId}
    </select>

    <select id="findByArticleId" parameterType="long" resultMap="articleRecommendMap">
        select *
        from ARTICLES_RECOMMEND
        where ARTICLE_ID = #{articleId}
    </select>

    <select id="findByUserId" parameterType="long">
        select *
        from ARTICLES_RECOMMEND
        where USER_ID = #{articleId}
    </select>

    <select id="countByArticleId" parameterType="long">
        select count(*)
        from ARTICLES as A
                 inner join ARTICLES_RECOMMEND as AR on A.ID = AR.ARTICLE_ID
        where AR.ARTICLE_ID = #{articleId}
    </select>

    <select id="countByUserId" parameterType="long">
        select count(*)
        from ARTICLES as A
                 inner join ARTICLES_RECOMMEND as AR on AR.ARTICLE_ID = A.ID
        WHERE AR.USER_ID = #{userId}
    </select>

</mapper>